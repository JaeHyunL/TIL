# 용어

**인덱스**: 데이터 저장공간 하나의 타입만 가지며 물리적인 노드에 여러개의 논리적인 인덱스를 생성할 수 있다.

**샤드**: 색인된 데이터는 물리적인 공간에 여러개 파티션으로 나뉘어 구성되는데 이 파티션을 샤드라고 부른다.

**타입**: 논리적 구조를 의미하며 인덱스 속성에 따라 분류하기도 함. 1인덱스 1타입.

**문서**: 데이터가 저장되는 최소 단위. JSON 데이터가 저장됨.

**필드**: 필드는 문서를 구성하기 위한 속성 데이터베이스의 칼럼과 유사할 수 있으나 보다 동적인 데이터 타입이라고 할 수 있음.

**매핑**: 문서의 필드와 필드의 속성을 정의하고 그에 따른 색인 방법을 정의하는 프로세스이다.

**노드**: 엘라스틱 서치의 경우 다수의 서버로 분산해서 처리하는것이 가능하기에

- 마스터 노드
  - 클러스터를 관리한다.
  - 노드 추가와 제거 같은 클러스터의 전반적인 관리 담당.
- 데이터 노드
  - 실질적인 데이터를 저장한다
  - 검색과 통계 같은 데이터 관련 작업을 수행행한다.
- 코디네이팅 노드
  - 사용자의 요청만 받아서 처리한다.
  - 검색과 통계같은 데이터 관련 작업을 수행한다.
- 인제스트 노드
  - 문서의 전처리 작업을 담당한다.
  - 인덱스 생성 전 문서의 형식을 다양하게 변경할 수 있다.

**마스터 노드**: 인덱스 생성 삭제 관련 작업을 담당하며 네트워크 속도가빠르고 지연없이 없는 노드를 마스터 노드로 생성해야 한다. 마스터 노드는 오직 한개.

**데이터 노드**: 데이터가 실제로 분산 저장되는 물리적인 공간인 샤드가 배치되는 노드이기도 하다. 컴퓨팅 리소스를 많이 소모하기 때문에 리소스 모니터링이 필요하다. 가능한 마스터 노드와 분리해서 구성.

**코디네이팅 노드**: 들어온 요청을 단순히 라운드로빈 방식으로 분산 시켜주는 노드이다.

**인제스트 노드**: 색인 앞에서 데이터를 전처리 하기 위한 노드이다. 스크립트로 전처리 파이프 라인을 구성할 수 있다.

**데이터 집계타임** : 4가지 API로 제공 됨.

- 버킷 집계
  - 집계 중 가장많이 사용한다. 문서의 필드를 기준으로 버킷을 집계한다.
- 메트릭 집계
  - 문서에서 추출된 값을 가지고 Sum, Max, Min, avg를 계산한다.
- 매트릭스 집계
  - 행렬의 값을 합하거나 곱한다.
- 파이프라인 집계
  - 버킷에서 도출된 결과 문서를 다른 필드 값으로 재 분류한다. 생성된 출력 결과를 다시 한번 집계한다. (패싯과 의 차이)

> 형태소 분석이 가능한 필드는 Text 아니면 Keyword나 다른 컬럼을 사용해도 됨 좀 더 읽어봐야할 듯.

**analyzer** : 해당필드의 데이터를 분석하겠다는 의미에 파라미터다. 색인과 검색 시 지정한 분석기로 형태소 분석을 수행한다. text 데이터 타입의 필드는 analyerzer 매핑 파라미터를 기본적으로 사용해야 한다.

**normalizer**: 매핑 파라미터는 term query에 분석기를 사용하기 위해 사용된다. 예를 들어 keyword 데이터 타입의 경우 원문을 기준으로문서가 색인되기 때문에 cafe, Cafe, CaFe는 서로 다른 문서로 인식된다. 하지만 해당 유형을 normalizer를 통해 분석기에 asciifolding과 같은 필터를 사용하면 같은 데이터로 인식되게 할 수 있다.

**boost**: 필드에 가중치를 부여한다. 가중치에 따라 유사도 점수가 달라지기 때문에 boost 설정 시 검색 결과의 노출 순서에 영향을 준다. 만약 색인 시점에 boost 설정을 하게 된다면 재색인하지 않는 이상 가중치를 변경할 수 없기 떄문에사용해야한다. 가급적 검색 시점에만 사용하는 것을 권장.

**corece**: 색인 시 자동변환을 허용할지 여부를 설정하는 파라미터다. 예를 들어 “10”과 같은 숫자 형태의 문자열이 integer 타입의 필드에 들어온다면 엘라스틱서치는 자동으로 형변환을 수행해서 정장적으로 처리한다. 하지만 corece 설정을 미사용으로 변경한다면 색인에 실패할 것이다.

**copy_to**: 매핑 파라미터를 추가한 필드의 값을 지정한 필드로 복사한다. 예컨대 keyword 타입의 필드에 copy_to 매핑 파라미터를 사용해 다른 필드로 값을 복사하면 복사된 필드에서는 text 타입을 지정해 형태소 분석을 할 수도 있따.

**fielddata**: 엘라스틱서치가 힙 공간에 생성하는 매모리 캐시다. doc_values라는 새로운 형태의 캐스를 제공하고 있으며, text 타입의 필드를 제외한 모든 필드는 기본적으로 doc_values 캐시를 사용한다. fielddata를 사용해야만 하는 경우도 있다. text 타입의 필드는 기본적으로 분석기에 형태소 분석이 되기 때문에 집계나 정렬 등의 기능을 수행할 수 없다. 하지만 부득이하게 text 타입의 필드에서나 집계나 정렬을 수행하는 경우도 있을 것이다. 이러한 경우에 한해 fielddata를 사용할 수 있다. 하지만 fielddata는 메모리에 생성되는 캐시이기 때문에 최소한으로만 사용해야 한다는 사실에 주의 해야 한다.fielddata는 메모리 소모가 크기 때문에 기본적으로 비활성화 돼ㅔ있다.