# ch01 소프트웨어 아키텍처 원칙

### 소프트웨어 아키텍처의 정의

소프트웨어 아키텍처는 소프트웨어 시스템의 서브시스템이나 컴퍼넌트, 이들 사이의 관계를 기술한 것이다.

### 소프트웨어 아키텍처 대 설계

- 아키텍처는 상위 수준의 서술 구조 및 시스템 안의 상호작용에 관련된다. 소프트웨어 아키텍처는 기능뿐 아니라 조직, 기술, 비즈니스와 품질속성을 포함한 시스템 골격에 관한 의사결정에 수반되는 질문들과 관련이 있다.
- 설계는 시스템을 만드는데 포함된 시스템과 하위 시스템의 부품이나 컴퍼넌트의 구성 관련보다 보통 설계문제는 다음과같은 코드나 모듈에 더 가깝다.
  - 코드로 분할되는 모듈은 무엇인가? 모듈은 어떻게 구성되는가?
  - 서로 다른 기능을 어떤 클래스에 해당해야 하는가?
  - 클래스 C에 어떤 디자인 패턴을 사용해야하는가?
  - 런타임에 얼마나 많은 객체들이 상호작용하는가? 전달되는 메시지는 어떤것이며 어떻게 상호작용을 조직화 하는가?

### 소프트웨어 아키텍처의 여러 측면

아키텍처에 관한 공식적인 IEEE 정의와 비공식적인 정의 모두에서 공통으로 반복되는 내용이 있다. 소프트웨어 아키텍처를 논의하려면 다음 주제를 이해해야 한다.

- 시스템: 시스템은 구체적인 기능을 달성하기 위해 특정 방법으로 구성된 컴퍼넌트들의 집합을 의미한다.
- 구조: 구조는 규칙이나 원칙에 따라 함꼐 그룹화되거나 구성된 요소 들의 집합이다. 하드웨어나 소프트웨어 시스템이 될 수도 있다.
- 환경: 소프트웨어가 만들어지는 컨텍스트나 환경으로 소프트웨어 아키텍처에 직접적인 영향을 미친다. 기술환경, 비지니스 환경, 운영환경 등이 될 수가 있다.
- 이해 당사자: 시스템과 시스템의 성공적인 관심을 갖거나 염려하는 사람이나 그룹 모두를 말한다. 이해당사자의 예로는 아키텍트, 개발팀, 고객 프로젝트 관리자 등이 있다.

### 소프트웨어 아키텍처의 특성

모든 소프트웨어 아키텍처에는 공통적인 특성이 있다. 갖아중요한 특성들을 살펴보자.

시스템 아키텍처를 구조적인 컴퍼넌트나 클래스 다이어그램으로 그리는 것이 가장 일반적이다.

- 런타임에 생성된 객체 관점에서 런타임 구조와 이들이 상호 작용 방법은 배포 아키텍처를 결정한다. 배포 아키텍처는 확장성, 성능, 보안, 상호 운용성 같은 품질속성에 밀접하게 관련된다.
- 작업 분할을 위해 코드가 세분화되고 모듈과 패키지로 구성되는 방법 측면에서 모듈 구조는 시스템의 유지보수성과 변경 용이성에 직접적인 영향을 준다. 이는 다음과 같이 설명된다.
  - 확장성을 고려해 구성된 코드는 적절한 문서화와 구성을 갖는 잘 정의돈 별도의 패키지에 부모클래스를 유지한다. 따라서 부모 클래스는 너무나 많은 의존성을 처리하지 않아도 외부 모듈에 따라 쉽게 확장이 가능하다.
  - (라이브러리, 프레임워크 같은) 외부 개발자나 서드 파티 개발자에 의존하는 코드는 수동 또는 자동으로 외부 소스에서 의존성을 가져오는 설정, 배포 단계를 제공해야 한다. 코드는 의존성 처리 단계를 명확하게 문서화한(README, INSTALL등 과 같은) 문서도 제공해야한다.

### 아키텍처는 핵심 요소의 집합을 선택한다.

### 아키텍처는 초기 디자인 결정사항을 기술한다.

- 시스템은 Linux 64-bit 서버가 클라이언트 요구사항과 성능 제약사항을 만족시키므로 해당 서버에만 배포된다.
- 시스템은 백엔드 API를 구현하기 위한 프로토콜로 HTTP를 사용한다.
- 시스템은 백엔드에서 프론트앤드로 중요한 데이터를 전송하는 API에 대해 2048비트나 그 이상의 암호화 인증서를 사용하는 HTTPS의 사용을 시도하단다.
- 시스템의 프로그래밍 언어로는 백엔드는 파이썬, 프론트앤드는 파이썬이나 루비를 사용한다.

### 아키텍처는 이해당사자의 요구사항을 관리한다.

궁극적으로는 시스템은 이해당사자의 요구에 따라 설계되고 만들어진다. 그러나 일부 요구사항은 모순적인 특성으로 인해 완전히 처리할 수 없다.

- 마케팅팀은 기능을 완전하게 갖춘 소프트웨어 어플리케이션에 관심이 있지만, 많은 기능이 추가되면 개발팀은 기능이 조금씩 늘어나는 문제와 성능 문제에 관심을 둔다.
- 시스템 아키텍처는 최신 기술을 사용해 배포를 클라우드까지 확장하는 것에 관심을 갖는 반면, 프로잭트 관리자는 배포 기술이 예산에 미칠 영향에 우려를 한다.
- 최종사용자는 기능, 성능 , 보안, 사용성 신뢰성에 관심을 갖는 반면 개발 조직은 프로잭트 일정을 지키면서 예산안에서 이러한 품질 사항을 모두 전달하는데 관심이 있다.
- 좋은 아키텍처는 트레이드 오프를 통한 요구사항의 균형을 맞추기 위해 최선을 다한다 또한 인력과 자원을 한도 이하로 유지하면서 좋은 품질속성을 갖는 시스템을 전달하려고 한다.
- 아키텍처는 제한사항의 표현을 통해 이해당사자들이 효과적으로 의사소통을 할 수 있도록 공통언어를 제공한다. 공통 언어는 아키텍트가 요규사항과 트레이드 오프를 가장 잘 기술한 아키텍처로 일원화하는데 도움이 된다.

### 아키텍처는 조직 구조에 영향을 미친다.

시스템은 아키텍처를 구조화 해서 시스템을 만드는 팀 구조와 직접적으로 매핑 될 때가 많다.

아키텍처는 많은양의 데이터를 읽고 쓰는 일련의 서비스를 기술하는데 데이터 액세스 계층을 갖고 있을 수 있다. 시스템에 필요한 기술 세트를 이미 보유하고 있는 데이터베이스 팀에 기능을 할당하는 것은 자연스로운 일이다.

시스템 아키텍처는 하향식 구조에 관한 최상위 서술이므로 작업 분할 구조 의 기반으로도 사용된다.

### 아키텍처는 환경의 영항을 받는다.

환경은 아키텍처가 반드시 갖춰야 하는 기능에 관한 외부 제약사항이나 제한을 부과하며, 컨텍스트 안의 아키텍처라고 한다.

다음과 같은 예가 있다.

- 품질속성 요구사항: 현대 웹애플리케이션에서는 초기 기술 제한사항으로 애플리케이션의 확장성과 가용성을 명시하고 이러한 사항을 아키텍처에 기술한다. 이것은 비지니스 측면의 기술적인 컨텍스트의 예다.
- 표준 준수: 소프트웨어를 관리하기 위한 대규모 표준 세트가 있는 조직도 있다. 특히 은행 보험, 건강 관리 분야가 그렇다 표준은 아키텍처의 제약사항으로 추가 되는데 이것이 기술 컨텍스트의 예다.
- 조직 제약사항: 특정 아키텍처 스타일에 경험이 있거나 이러한 스타일을 포함하는 특정 프로그래밍 환경을 운영하는 일련의 조직들을 볼 수 있따. 조직은 비용절감 방법을 향후 프로젝트에 유사한 아키텍처의 적용을 선호하고 아키텍처와 곤련된 기술에 투자로 생산성을 보정받는다. 이것은 내부 비즈니스 컨텍스트의 예다.
- 전문 컨텍스트: 외부 컨텍스트를 제외하고 시스템 아키텍처에 관한 아키텍트의 선택 세트는 대부분 아키텍트의 고유한 경험을 바탕으로 형성된다. 아키텍트는 새로운 프로잭트를 위해 과거에 가장 성공적이었던 아키텍처적인 선택사항들을 계속 사용한다.

아키텍처 선택사항은 자체 교육 및 전문적인 교육과 훈련에서 비롯되며 전문 기술이 있는 동료의 영향도 받는다.

### 아키텍처는 시스템을 문서화한다.

모든 시스템은 공식적인 문서화 여부와 상관없이 아키텍처를 갖는다. 적절하게 문서화된 아키텍처는 효과적인 시스템 문서 역할을 할 수 있다. 아키텍처는 시스템의 초기 요구사항, 제약사항, 이해당사자 트레이드 오프를 기술하기 떄문에 아키텍처를 적절하게 문서화하는것이 좋다. 문서는 나중에 교육을 위한 기초 자료로도 사용할 수 있다.

### 아키텍처는 패턴을 준수한다.

실제로 대부분의 아키텍처는 많은 성공을 거둔 특정 아키텍트 스타일을 준수한다.

이러한 패턴의 예로는 클라이언트-서버, 파이프와 필터, 데이터 기반 아키텍처 등이 있다.

### 소프트웨어 아키텍처의 중요성

지금까지 소프트웨어 아키텍처의 기본과 원칙과 특성을 살펴 보왔따 물론 소프트웨어 아키텍처는 중요하며 소프트 웨어 개발 프로세스의 중요한 단계라고 가정했따.

### 왜 공식적인 소프트웨어 아키텍처 없이 시스템을 구축하지 않는가?

- 모든 시스템은 문서화 여부와 상관없이 아키텍처를 갖는다.
- 아키텍처 문서화를 공식화하고 여러 이해당사자에게 공유할 수 있따면 변경 관리와 반복 개발이 가능하다.
- 공식적인 아키텍처가 정의되고 문서화되면 소프트웨어 아키텍처의 모든 이점과 특성을 활용 할 수 있다.
- 공식적인 아키텍처 없이도 작업을 진행하고 원하는 기능을 갖춘 시스템을 구축 할 수 있다. 그러나 확장 가능하고 수정을 할 수 있는 시스템을 만들 수 없을것이다. 원래 요구사항과 상당히 거리가 먼 품질 속성 세트를갖는 시스템을 만들 가능성이 크다.

### 시스템 아키텍처 대 엔터프라이즈 아키텍처

- 기술 아키텍트: 기술 아키텍트는 조직에서 사용되는 핵심 기술 에 관련된다.
- 보안 아키텍트: 보안적인 요소와 전략을 생성 조정
- 정보 아키텍트:: 비지니스 목표를 촉진시키는 방법으로 애플리케이션에서 이용할 수 있는 아키텍처 솔루션을 제시한다.
- 인프라스트럭쳐 아키텍트: 각 비지니스 도메인의 더 작은 그림들을 이햐하게 한다

시스템 아키텍트: 시스템 아키텍트는 전략보다 기술에 중점을 둔다. 서비스 지향 소프트웨어 조직에서 특정 클라이언트를 위한 솔루션을 생성하기 위해 서로 다른 시스템을 결합하는 솔루션 아키텍트를 둔다. 이때 조직의 크기, 프로젝트의 구체적인 시간 및 비용 요구사항에 따라 다양한 아키텍트 역할이나 하나로 결합된다.

솔루션 아키텍트: 전형적으로 솔루션 아키텍트는 전략 대 프로잭트 범위 중간에 위치한다.

### 아키텍처 품질속성

아키텍처의 품질 속성들은

- 변경 용이성
- 테스트 용이성
- 확장 가능성과 서능
- 가용성
- 보안
- 배포용이성

### 변경 요이성

일반적인 소프트웨어 시스템의 비용의 80%가 초기 개발과 배포 이후에 벌생한 것이다.

아키텍트 관점에서 변경용이성의 관심 내용은 다음과 같다.

- 난이도: 시스템 변경의 용이성
- 비용: 변경하기 위해 필요한 시간과 자원 관점
- 위험: 시스템 변경에 관련된 모든 위험

변경 종류:

1. 지역 변경: 특정 요소에만 영향을 미친다, 요소는 함수, 클래스, 모듈과 같은 일부코드나 XML, JSON 파일 같은 구성요소가 될 수 있다.
2. 비지역 변경: 비지역 변경은 하나 이상의 요소를 포함한다.

- 데이터베이스의 스키마 변경은 애플리케이션 코드 안의 스키마를 나타내는 모댈클래슫르을 순처적으로 처리해야 한다.
- JSON 파일에 새로운 구성 파라미터의 추가는 팡리을 파싱하거나 파라미터를 파싱하는 애플리케이션의 파서에 의해 처리돼야 한다.

비지역 변경은 지역 변경보다 변경이 더 어려우며 주의 깊은 분석이 필요하다.

가능하면 코드 회귀를 방지하기 위해 통합테스트가 필요하다.

1. 전역 변경사항: 상위의 아키텍처 변경을 포함하거나 소프트웨어 시스템의 중요 부분들로 이어지는 전역 수준 요소를 변경을 포함한다. 전역 변경 예제는 다음과 같다.
   - rsutful에 메시징 기반 웹 서비스로의 시스템 아키텍처 변경
   - Django에서 Angujs 기반 컴퍼넌트로 웹 어플리케이션의 컨트롤러 변경
   - 프론트엔드에서 온라인 뉴스 애플리케이션에 관한 인라인 모델 API호츨을 피하기 위해 모든 데이터가 선행적 로드가 필요한 성능 요구사항의 변경

이러한 변경읜 자원 시간 및 비용 측면에서 가장 위험하며 비용도 가장 많이 든다.

### 테스트 용이성

테스트 용이성은 테스팅을 통해 소프트웨어 시스템이 결함을 보여줄 수 있는 정도를 의미한다. 테스트 용이성은 최종 사용자와 시스템 통합 테스트에 대해 오류를 감추는 정도만 생각할 수도 있다. 더 많은 테스트를 할 수 있는 시스템일수록 결함을 숨길 가능성이 줄어든다.

### 확장성

수평적 확장( scale out)

수직적확장 (scale up)

### 성능

컴퓨팅 단위 자원을 사용해 달성한 작업 량이다.

- 응답시간: 실제 시간 클럭 시간 관점에서 기능이나 실행단위가 수행되는데 걸리는 시간이다ㅣ.
- 지연시간: 시스템이 자극을 받고 응답하는데 걸리는 시간이다. 지연 시간의 한가지 예는 최정 사용자 관점에서 측정한 웹 애플리케이션의 요청 응답 루티를 완료하는데 걸리는시간
- 처리량: 시스템의 정보 처리속도이다. 일반적으로 높은 성능을 갖는 시스템은 상대적으로 높은 처리량과 확장성을 갖는다. 분당 완료 트랜잭션 수로 측정되는 전자상거래 웹사이트의 처리량을 예로 들 수 있따.

수평적 확장성은 시스템의 자체 컴퓨팅 노드에서는 시스템 성능과 직접적인 관련이 없는 것으로 여겨진다. 그러나 시스템이 네트워크를 효과적으로 사용하지 않는 방식으로 작성되면 네트워크 지연 문제가 발생된다. 네트워크 지연에 소요되는 시간은 작업을 배포하는 것에 확장성의 모든 이득을 상쇄하기 때문에 수평 확장에 문제가 된다.

파이썬 같은 동적 프로그래밍 언어는 수직 확장을 할 때 내장된 확장성 문제가 있다. 예를ㄷ들어 파이썬 GIL은 멀티스레드가 계산할 떄 이용할 수 있는 CPU 코어의 최대 사용 개수를 제한한다.

### 가용성

가용성은 작업을 해야 할 때 소프트웨어 시스템이 작업을 실행할 준비가 돼있는지를 나타내는 속성이다.

대표적으로\

장애감지, 요루 복구, 장애 복구시간 용어가 여기서 나옴

### 보안

소프트웨어 분야에서 보안은 적절하게 인증된 다른 시스템에 관해 서비스를 계속 제공하면서 인증되지 않은 접근으로 부터 데이터 및 로직의 손상을 방지하기 위한 시스템 능력정도로 정의 돌 수 있따.

### 배포 용이성

배포 용이성은 소프트웨어 기본 품질속성 중 하나가 아니다. 그러나 파이썬 프로그래밍 언어에서 배포 용이성은 에코시스템의 다양한 측면에서 중요한 역할을 하며 프로그래머에게 유용하기 떄문에 이책에서 다룬다.

배포 용이성을 결정하는 몇가지 요소들이다.

- 모듈 구조: 시스템이 쉽게 배포 가능한 하위 단위로 구분된 프로잭트
- 프로덕션 환경 대 개발 환경: 개발 환경과 매우 유사한 프로덕션 환경을 가지고 있으면 배포가 쉽다.
- 개발 생태곚 ㅣ원: 시스템 런타임을 지원하는 성숙한 툴체인이 있으면 의존성과 같은 구정사항이 자동으러 설정되게끔 할 수 있으므로 배포가능성을 증가시킨다.
- 표준 구성: 프로덕션 환경에 모두에 구같은 구성을 유지하는것은 좋은 아이디어다.
- 표주화된 인프라스트럭처: 배포를 동일하거나 표준화 된 이프라스터럭처 세트로 유지하면 배포 용이성에 엄창난 도움이 된다는 것은 잘 알려져 있다.
- 컨테이너 사용: 리눅스 컨테이너 상단에 구축되는 도커와 베이그란트 같은 기술을 사용