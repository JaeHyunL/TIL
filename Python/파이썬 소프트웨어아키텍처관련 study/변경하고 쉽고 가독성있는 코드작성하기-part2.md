

### 코딩 및 스타일 가이드라인 준수하기

프로그래밍 언어는 상대적으로 잘 알려진 코딩 및 스타일 가이드라인을 갖고 있다.

PEP8은 파이썬의 독창정인 코딩 스타일이며 다음과 같이 요약가능하다.

- 코드는 작성된 것이기보다는 읽는 것이다. 따라서 가이드라인을 제공하면 코드를 더 쉽게 읽기 쉽게 만들 수 있으며 파이썬 코드가 일관성을 뛴다.
- 프로젝트의 일관성은 중요하다. 그러나 모듈이나 패키지의 일관성이 더 중요하며 클래스나 함수같은 단위 코드의 일관성이 가장 중요하다.
- 가이드라인을 무시해야 할 때를 알아야 한다. 예를 들면 가이드라인을 적용하면 코드 가독성을 떨어뜨리고, 주요 코드를 망치거나 코드의 하위 호환성을 손상시키는 경우다.
- 조직에 가이드라인을 직접 적용할 수 없거나 유용하지 않으면 가이드라인을 커스터마이징해야한다. 가이드라인에 의문이 있따면, 파이썬 커뮤니티에 도움을 요청하고 궁금한 점을 해소해야 한다.

### 코드 리뷰와 리팩토링

코드는 유지보수해야 한다. 프로덕션 환경에서 유지보수되지 않은 코드를 사용하면 문재가 발생할 수 있으며 주기적인 유지보수가 없으면 참사가 일어난다.

리뷰는 애플리케이션에는 익숙하지만 같은 코드로 작업할 필요가 없는 엔지니어가 해야한다. 리뷰는 코드에 새로운 시각을 갖도록 해서 작성자가 간과한 버그를 감지하는데 도움이 된다.

### 코드에 주석달기

- 주석은 서술적으로 코드를 설명해야 하며 함수 이름에서 얻을 수 있는 명백한 사항을 단순하게 반복하는 주석은 유용하지 않다.
- 코드 주석은 추가하려는 블록 앞에 작성되어야 한다.
- 인라인 주석이 코드의 일부로 혼동될 수 있어 가능한 적게 사용해야 한다. 특히 주석 문자가 실수로 지워지면 버그의 원인이 되기도 한다.
- 불필요하며 가치 없는 주석을 피해야 한다.

### 변경 용이성의 기본 사항 - 응집도와 결합도

‘변경 용이성’ 주제로 돌아와 코드의 변경 용이성에 영향을 주는 두 가지 기본 사항을 알아본다. 1장에서 개념을 훓어봤는데 다시 한번 빠르게 검토해보자.

응집도란 모듈의 책임이 얼마나 긴밀하게 연관돼 있는지 말한ㄷ. 특정 작업이나 관련된 작업 그룹을 수행하는 모듈은 높은 응집도를 갖는다. 핵심기능에 대한 고려없이 많은 기능을 갖는 모듈은 낮은 응집도를 갖게된다.

결합도는 두 모듈 A와 B 기능이 관련된 정도다. 함수나 메소드 호출에 관련해 코드 수준에서 기능이 강하게 중첩되면 두 모듈은 강하게 결합된다. 아마도 모듈 A의 모든 변경사항에는 모듈 B의 변결을 필요할 것이다.

강력한 결합도 기반 코드의 유지보수 비용을 증가시키기 떄문에 변경 용이성을 위해 항상 금지된다.

### 응집도와 결합도 측정하기

두 모듈의 결합도와 응집도를 정량적으로 측정하는 방법을 이해하기 위해 간단한 두 모듈의 예를 살펴보자. 다음은 의도적으로 일련의 숫자로 동작하는 기능을 구현하는 모듈 A의 코드다.

‘’’ 중략

### 변경 용이성을 위한 전략

결합도와 응집도의 좋은 경우와 나쁜 경우의 예시를 살펴봤따 소프트웨어 시스템의 변경 용이성을 향상시키기 위해 사용할 수 있는 전략과 접근방법을 살펴보자. 이들은 소프트웨어 설계자나 아키텍트가 변경용이성에 결합도와 응집도의 영향을 감소시키는데 사용할 수 있다.

### 명시적인 인터페이스 사용하기.

모듈의 함수, 클래스나 메소드의 집합을 외부 코드에 제공하는 인터페이스로 표시하고 제공해야 한다. 이것은 외부로 내보내는 모듈의 API로 생각할 수 있는데 API를 사용하는 모든 외부 코드는 모듈의 클라이언트가 된다.

모듈이 내부 함수로 고려하고 API로 구성하지 않는 메서도나 함수들은 명시적으로 모듈 전용으로 만들거나 해당 사항을 문서화 해야한다.

함수나 클래스 메소드에 관한 가변 액세스 범위를 제공하지 않는 파이썬에서, 함수 이름 앞에 하나 또는, 두 개의 밑줄_을 사용하는 명명 규칙으로 구현 할 수 있따. 따라서 이러한 함수들은 잠재적으로 클라이언트에게 내부에서 사용되며, 외부에서 참고해서는 안 된다는 신호를 보낸다.

### 양방향 의존성 감소시키기

앞의 예제에서 본 것 같이 두 소프트웨어 모듈 사이의 결합은 단방향이면 관리할 수 있다. 그러나 양방향 결합은 모듈 사이의 강력한 결합을 생성하며 모듈의 사용을 복잡하게 만들고 유지보수 비용을 증가시킨다.

양방향 의존성은 코드를 한 모듈이 언제나 다른 하나를 사용하고 그 반대는 허용하지 안흔 방법으로 리팩토링해서 제거할 수 있다. 즉 가은 모듈의 모든 관련 함수를 캡슐화 해야한다.

다음은 앞의 예에서 모듈 A와 B의 양방향 의존성을 제거하고 다시 작성한 것이다.

### 공통 서비스 추상화 하기

공통 함수와 메소드를 추강화 하는 헬퍼 모듈를 사용하면 두 모듈 사이의 결합도를 감소시키고 응집도를 증가시킬 수 있다. 예를들어 첫 번째 예제에서 모듈 A는 모듈 B의 헬퍼로 동작한다. 두 번째 예제에서 리팩토링을 거친후 모둘 A 는 B의 헬퍼로 동저ㅏㄱ한다.

헬퍼 모듈은 다른 모듈에 공통 서비스를 추강화 하는 중재자나 중개인으로 생각할 수 있다. 따라서 의존성을 갖는 코드는 모두 중복없이 한 곳에서 추상화 한다. 불필요하거나 관련 없는 기능을 적절한 헬퍼 모듈로 이동시켜 모듈의 응집력을 높일 수 있다.

### 상속 기법 사용하기

클래스에서 유사한 코드나 기능이 발견되면 클래스 계층 구조를 생성해 공통 코드가 상속을 통해 공유되도록 리팩토링하기 좋은 경우다.

### 늦은 바인딩 기법의 사용

늦은 바인딩은 코드 실행순서에서 가능한 늦게 파라미터 값을 바인딩하는 지연 관행을 말한다. 늦은 바인딩은 프로그래머가 코드 실행에 영향을 주는 요소들의 처리를 나중으로 미루고 다양한 기법을 사용해 코드 실행 결과와 수행 처리를 나중에 한다.

- 플러그인 메커니즘: 결합도를 증가시키는 모듈들을 정적으로 함께 바인딩 시키는 것이 아니라 특정한 의존성이 있는 플러그인을 로드해서 런타임 시점에 값을 처리한다. 플러그인은 런타임 시점의 계산 수행 도중에 이름을 가져오는 파이썬 모듈이나 데이터베이스 쿼리, 구성 파일에서 로드되는 ID나 변수 이름이 될 수 있따.
- 브로커/레지스트리 조회 서비스: 일부 서비스들은 완전하게 브로커로 이관할 수 있다. 필요에 따라 브로커는 레지스트리에서 서비스 이름을 조회하고 동적으로 호출해 결과를 반환한다. 하나의 예로 런타임에 동적으로 서비스를 검색하고 입력 통화를 특정 통화로 변환하는 통화 변환 서비스가 있따. 따라서 시스템에서는 항상 같은 코드를 실행하면 된다. 그러면 시스템에는 입력에 따라 달라지는 의존성 코드가 사라진다. 따라서 변환 로직은 외부 서비스에 있기 때문에 시스템은 필요한 모든 변경에 영향을 받지 않는다.
- 알림서비스: 게시 구독/메커니즘은 객체 값이 바뀌거나 이벤트가 게시되면 구독자에게 알려주며 휘발성 파라미터와 그 값을 시스템에서 분리하는데 유용하게 사용할 수 있따. 이렇나 시스템들은 많은 의존성 코드 및 구조가 필요한 변수 객체 변경사항을 내부적으로 추적하기 보다는 변경된 값을 클라이언트에게 알리는 외부 API에만 바인딩 되도록 한다. 따라서 객체 내부의 동작에 영향을 주고 트리거하는 변경사항에 클라이언트들이 영향을 받지 않도록 유지할 수 있다.
- 배포시 바인딩: 구성 팡리에 이름이나 ID 관련 변수 값을 유지해 객체/변수의 바인딩을 배포 시기로 미룰 수 있다. 값들은 시작할 때 구성 파일의 로드를 통해 소프트웨어 시스템에 바인딩되고 난 후 적절한 객체를 생성하는 코드 안에서 특정 경로로 호출 할 수 있다. 이러한 방법은 주어진 이름과 ID로 실행 시점에 필요한 객체를 생성하는 팩토리 같은 객체 지향 패턴과 결합할 수 있다. 따라서 객체에 의존하는 클라이언트를 내부에 변경에 영향을 받지 않도록 유지하고 변경 용이성을 증가시킨다.
- 생성 해턴 사용: 팩토리 패턴이나 빌더 패턴 같은 생성 디자인이 패턴은 객체의 세부사항에 생성에 객체를 생성하는 작업을 추상화한다 이는 종속 객체의 세부사항 생성에 객체를 생성하는 작업을 추상화한다. 이는 종속 객체의 생성코드가 변경되면 코드가 수정 되는 것을 원치 않는 클라이언트 모듈의 관심사를 분리하는데 이상적이다.

### 메트릭 - 정적분석을 위한 도구

정적 코드 분석 도구는 코드의 복잡도와 변경 용이성, 가독성에 통찰력을 주는 코드의 정적 특성에 관한 풍부한 정보를 제공한다

파이썬에서는 당므과 같이 코드의 정적측면을 측정하는데 도임이 되는 다양한 서드파티 지원 도구가 있다.

- PEP-8같은 코딩 표준
- 맥케이브 메트릭 같은 코드 복잡도 메트릭
- 구문 오류, 들여쓰기 문제, 임포트 오류, 변수 덮어쓰기 같은 오류
- 코드의 로직문제
- 코드의 나쁜 냄세