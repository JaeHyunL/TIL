# ch02 변경하기 쉽고 가독성 있는 코드 작성하기

> 학습 목표변경 용이성의 집중에서 학습.

### 변경 용이성이란 무엇인가?

아키텍처 품질속성 중 변경 용이성은 다음과 같이 정의한다.

변경 용이성은 시스템의 변경을 쉽게 할 수 있는 정도이며 시스템 변경에 적응할 수 있는 우영성이다.

### 변경 용이성 관련 측면

변경 용이성을 좀 더 논의하고 변경 용이성에 밀접하게 관련돼 잇는 몇 가지 품질 속성을 알아본다.

- 가독성: 가독성은 프로그램 로직을 쉽게 따라가고 이해할 수 있는 정도로 정의할 수 있다. 가독성 있는 소프트웨어는 사용되는 프로그래밍 언어가 채택한 가이드라인에 따라 특정스타일로 작성된 코드이며 로직은 간결하고 명확한 방법으로 언어에서 제공하는 기능을 사용한다.
- 모듈성: 모듈성은 기능이 매우 구체적으로 잘 문서화돼 있는 캡슐화된 모듈로 소프트웨어 시스템이 작성돼 있음을 의미한다. 모듈화돈 코드는 시스템의 나머지 부분에 대해 프로그래머에게 친화적인 API를 제공한다. 변경 용이성은 재사용과도 매우 밀접한 관련이 있다.
- 재사용성: 재사용성은 수정을 하지 않거나 아주 적은 변경으로도 시스템의 다른 부분에서 재사용할 수 있는 코드, 도구, 디자인 등을 포함한 소프트웨어 시스템의 부품 수를 측정한다. 좋은 디자인은 처음부터 재사용성을 강조한다. 재사용성은 소프트웨어 개발의 DRY 원측을 구현한다.
- 유지보수성: 소프트웨어의 유지보수성은 시스템을 업데이트할 수 있는 편의성과 효율성으로, 의도된 이해당사자들이 유용한 상태에서 작업을 계속 할 수 있도록한다. 유보수성은 변경 용이성, 가독성, 모듈성, 테스트 용이성을 포골화는 메트릭이다.

### 가독성 이해하기

소프트웨어 시스템의 가독성은 변경 용이성과 밀접한 관련이 있다. 잘 작성되고 문서화 된 프로그래밍 언어는 표준이나 커뮤니티가 채택한 사례를 따르며, 읽고 변경하기 쉬운 간단하고 간결한 코드를 만드는 경향이 있다.

가독성은 훌륭한 코딩 가이드라인을 따르는 것뿐 아니라 로직이 얼마나 명확한지, 코드가 언어 표준 기능을 얼마나 사용하는지, 기능이 얼마나 모듈화돼 있는지도 관련이 있다.

가독성의 다양한 측면을 요약하면 다음과 같아.

- 잘 작성된 코드: 코드가 간단한 구문을 사용하고 언어의 잘 알려진 기능과 어법을 사용한다. 로직이 명확하고 간결하며 변수, 함수, 클래스/모듈의 이름을 의미있게 사용해 이름이 함수나 변수가 하는일을 표현하고 있따면 코드가 잘 작성됐다고 말한다.
- 잘 문서화된 코드: 문서화는 코드 안 인라인 주석을 말한다. 잘 문서화된 코드는 코드가 무엇을 하는지 입력변수가 있따면 입력 인수가 무엇인지, 반환값이 있을 때 로직이나 알고리즘에 따른 반환값이 무엇인지 모든 사항을 상세하게 알려준다. 잘 문서화된 코드는 모든 외부라이브러리와, API의 사용. 인라인이나 별도 파일로 코드를 실행할 떄 필요한 구성사항도 문서화한다.
- 잘 형식화된 코드: 대부분의 프로그래밍 언어 특히, 분산돼 있지만 밀접하게 관련된 프로그래밍 커뮤니티와 인터넷을 통해 개발된 오픈소스 언어는 잘 문서화된 가이드라인을 갖고 있다. 들여쓰기와 서식도 가이드라인을 따르는 코드가 따르지 않는 코드보다 가독성이더 좋다.

### 파이썬과 가독성

파이썬은 기본적으로 가독성을 고려해 설계된 언어다. 잘 알려진 젠오브 파이썬에서 한 줄 빌리면 다음과 같다.

가독성은 중요하다 Readability counts

프로그래밍 언어 측면에서 파이썬은 가독성을 강조한다. 파이썬은 대응되는 영어 단어를 모방한 명확하고 간결한 키워드르 ㄹ통해 가독성을 높이며 다음과 같은 철학을 따른다.

‘’’무언가를 할 수 있는 한가지 분명한 방법이 있어야 한다’’’

파이썬에서 시퀀스를 반복하면서 인덱스를 출력하는 방법중 하나가 다음과 같다.

```python
for idx in range(len(seq)):
    item = seq[idx]
    print(idx, '=>', item)

# 그러나 파이썬에서 사용되는 좀 더 일반적인 관용구는 시퀀스애서 각 항목에 두 개의 튜플을 반환하는
# 반복자를 대상으로 enumerate() 헬퍼를 사용하는 것이다.

for idx, item in enumerate(seq):
    print(idx, '=>', item)
```

첫 번째 버전의 코드는 C++, 자바, 루비 같은 프로글매ㅣㅇ 언어에서 두 번째 버전의 코드와 똑같이 좋은 코드로 여겨진다. 그러나 파이썬에서는 다른 언어보다 언어의 원칙을 유지하는 코드를 위한 특정 관용구가 있다. 두번 째 버전이 파이썬 프로그래머가 문제를 해결하기 위해 코드를 작성하는 방법에 더 가깝다.

파이썬 적인 pythonic 이라는 용어는 파이썬 커뮤니티에서 흔히 볼 수 있다.

> 파이썬적인 정의는 주관적이다. 그러나 파이썬 코드가 젠 오브 파이썬을 유지하거나 커뮤니티에서 잘 알려진 관용적인 프로그래밍 사례를 따른다고 생각 할 수 있다.

파이썬은 디자인 원칙과 깔끔한 구문을 따라 가독성 있는 코드를 쉽게 작성할 수도 있도록한다. 그러나 C++나 자바같이 조금 더 추상적이고 덜 관용적인 다른 언어에서 파이썬으로 이전하는 프로그래머가 덜 파이썬 적인 방법으로 파이썬 코드를 작성하는 것은 흔히 볼 수 있는 함정이다. 예컨대 첫 번째 버전의 루프는 어느 정도 파이썬 코딩 경험이 있는 사람보다느 ㄴ다른언어에서 파이썬으로 이전한 프로그래머가 작성한 코드일 가능성이 높다.

파이썬 프로그래머가 언어에 익숙해질수록 관용적이거나 파이썬 적인 코드를 작성하는 경향이 있다. 코딩 원칙과 관용에서 익숙해지면 장기적으로 다른 언어보다 파이썬을 통해 생산성을 높일 수 있따.

### 가독성 - 안티패턴

파이썬은 가독성 있는 코드의 작성을 장려하고 코드를 쉽게 작성할 수 있도록 한다. 그러나 파이썬으로 작성된 모든 코드가 가독성이 높다고는 말하는 것은 비현실적이다.

파이썬에는 잘못 작성된 코드가 일부 있어 읽기 어렵거나, 웹에서 파이썬으로 작성된 오픈소스처럼 사람들이 검색하는데 시간이 오래걸리는가독성 없는 코드도 있따.

프로그래밍 언어에는 읽기 어렵거나 가독성 없는 코드를 만드는 특정 사례가 있다. 사례를 보면 파이썬뿐만 아니라 다른 프로그래밍 언어에서도 골칫거리인 안티패턴으로 생각할 수 있다.

- 주석이 거의 없는 코드: 코드 주석이 부족하면 가독성 없는 코드가 된다. 프로그래머는 코드에서 특정 구현을 유도하는 자신의 생각을 문서로 작성하지 않을 때가 많다. 몇 달 후 본이니다 다른프로그래머가 코드를 읽을 때. 왜 그렇게 구현했는지 이해하기 어렵고 대안의 장점과 근거도 추론하기 어렵다. 또한 고객이 문제를 해결하기 위한 코드 수정의 결정을 내리기 어렵게 하고 장기적인 관점에서 코드의 변경 용이성에도 영향을 미친다. 코드에 주석을 다는 것은 코드를 작성한 프로그래머에게 규율과 엄격함의 지표가 되며, 이런 관행을 시행하는 조직에도 같은 지표가 된다.
- 언어의 모범 사례를 위반하는 코드: 프로그래밍 모범 사례는 개발자 커뮤니티에서 수년 동안의 사용 경험에서 나온 효과적인 피드백을 통해 발전한다. 개발자 커뮤니티는 프로그램 언어에서 문제를 해결하는데 유용한 가장 좋은 방법을 포착한다. 개발자 커뮤니티에서는 언어를 사용하기 위한 관용구와 일반적인 패턴을 발견하기 쉽다. 가령, 파이썬에서 젠은 파이썬의 모범 사례를 빛내는 ‘횃불’로 추앙받는데, 젠은 커뮤니티가 채택한 일반적인 프로그래밍 관용구의 집합이기도 하다.
- 프로그래밍 안티패턴: 읽기 오렵고 유지보수가 힘든 코드를 생성하는 코딩과 프로그래밍의 안티패턴이 많다. 잘알려진 안티패턴을 소개한다.
  - 스파게티 코드: 인식할 수 있는 구조나 제어 흐름이 없는 코드다. 무조건 적인 점프와 구조화 되지 않은 예외처리 잘못 설계된 동시성 구조 등 복잡한 논리가 많이 생성된다.
  - 커다란 진흙공: 전체 구조나 목표가 보이지 않는 코드를 포함한 시스템이다. 커다란 진흙공은 많은 스파게티 코드로 구성돼 있고, 여러 사람을 거쳤으며, 문서화가 거의 없이 여러 번의 패치를 발행한 코드다.
  - 복사/붙여넣기 프로그래밍: 사려 깊은 설계보다. 전달 편이성을 선호나는 조직에서 만들어진다. 복사/붙여넣기 코딩은 길고 반복적인 코드 덩어리를 만들어낸다. 복사/붙여넣기는 사소한 변경사항에도 반복적으로 같은 작업을 한다. 코드를 부풀어 오르게 하고 장기적인 관점에서는 유지보수도 할 수 없게 만든다.
  - 에고 프로그래밍: 에고 프로그래밍은 프로그래머 특히 숙련된 프로그래머가 문서화된 모범 사례나 조직의 코딩 스타일보다 개인적인 스타일을 선호하는 경우다. 에고 프로그래밍은 다른 사람들, 특히 어리거나 경험이 없는 프로그래머들이 보기엔 어려운 암호화된 코드를 생성한다.

조직에 구조화된 프로그래밍 사례들을 적용하고 코딩 가이드라인과 모범 사례를 강제화하며 안티패턴을 방지할 수 있다.

다음으로 파이썬에 특화된 안티패턴을 소개한디.

- 혼합된 들여쓰기: 파이썬은 코드 블록을 분리하기 위해 들여쓰기를 한다. 다른언어 보다 중괄호나 다른 구문 구조가 부족하기 때문이다. 그러나 파이썬에서 들여쓰기를 할떄 주의해야한다.
- 문자열 리터럴 타입의 혼합사용: 파이썬은 문자열 리터럴을 생성하기 위해 세가지 방법을 제공한다 작은따옴표 큰따옴표 삼중따옴표 가 있다. 코드나 기능 단위의 블록에서 세가지 유형의 리터럴을 혼합해서 사용하는 코드는 읽기가 어려워진다.
- 기능 구문의 과도한 사용: 파이썬은 혼합 패러다임 언어이며 람다 키워드와, map, reduce, filter함수를 통한 함수형 프로그래밍을 지원한다. 그러나 숙력된 프로그래머나 함수형 프로그래밍에 배경을 갖고 파이썬을 사용하는 프로그래머들은 코드를 생성하기 위해 이러한 구문을 과도하게 사용한다.

### 가독성 기법

코드 가독성에 도움이 되는 훌륭한 지식을 알게 됐으므로 파이썬에서 코드의 가독성을 향상 시키는 방법을 아라보자.

### 코드의 문ㅛㅇ을 코드의 일부로 폼해서화

코드 가독성을 높이는 간단하고도 효과적인 방법은 코드가 무엇을하는지 문서화하는것이다. 코드의 가독성과 장기적인 변경 용이성 측면에서 문서화가 중요하다.

코드 문서화는 다음과 같이 분류할 수 있따.

- 인라인 문서화: 프로그래머는 코드 주석, 기능 문서화, 모듈 문서화, 다른 내용을 코드의 일부로 포함해 코드를 문서홯나다. 가장 효과적이고 유용한 코드 문서화 유형 방법이다.
- 외부 문서: 추가 문서로 분리된 파일에 기술한다. 코드사용, 코드 변경사항, 설치 단계, 배포 문서홯나다. 예로는 README, INSTALL, CHANGELOG, GNU 빌드 원칙에 부합하는 오픈소스 프로젝트에서 발견할 수 있는 파일들이다.
- 사용자 매뉴얼: 전담 인력이나 팀에 의한 공식 문서로 시스템 사용자를 대상으로 그림과 텍스트를 사용한다. 이 문서는 제품이 안정화되고 출하 준비가 되는 소프트웨어 마지막 시점에 문서를 준비해 전달한다. 사용자 매뉴얼에 관심을 두지 않는다.

파이썬은 처음부터 스마트 인라인 코드 문서화를 위해 설계된 언어다. 파이썬에서 인라인 문서화는 다음과 같은 수준에서도 수행이 가능하다.

- 코드 주석: 코드에 있는 인라인 텍스트로 해시 문자가 앞에 붙는다. 코드에서 자유롭게 서용 될 수 있으며 코드의 각 단계에서 무엇을 하는지 설명한다.
- docstrings 기능: 파이썬은 함수 정의 바로 다음에 문자열 리터럴을 이용해 함수가 무엇을 하는지 문서화하는 간단한 방법을 제공한다. 문자열 리터럴의 세가지 유형 중 하나를 사용해 문서화 할 수 있따.

클래스 문서화 문자열이 클래스의 주요 메소드를 어떻게 정의하는지 살펴보자. 각 함수의 문서화를 별도로 살펴보지 않고도 프로그래머에게 최상위 수준에서 유용한 정보를 주기 떄문에 매우 좋은 예다.

- 모듈문서화 문자열: 모듈 문서화 문자열은 모듈 수준의 정보를 기술한다. 모듈의 기능과 멤버 의 세부 정보 일부를 기술한다. 구문은 클래스나 함수의 문서화를 문자열과 같다. 해당 정보는 모듈 코드의 시작 부분에 기술된다. 모듈 문서화는 의존성이 명확하지 않을 때 모듈의 특정 외부 의ㅈㅎㄴ성도 기술 할 수 있따.